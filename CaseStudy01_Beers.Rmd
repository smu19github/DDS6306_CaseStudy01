---
title: "Evaluation of Craft Breweries in the <br> United States of America <br>"
author: "<br>Heindel Adu, Amy Markmum and Gabriel Gonzalez <br>- AGH Data Consult Inc."
date: "Spring 2019"
output: 
  html_document: 
    highlight: pygments
    keep_md: yes
    theme: united
---
#
#<br>
#

#### Load the necessary library packages prior to loading the data. 
#### Packages used include : 
####   <em>  -tidyr
####   <em>  -dplyr
####   <em>  -plotly
####      -plotly
####      -forcats 

```{r setup, include=FALSE}
library(tidyr)
library(dplyr)
library(plotly)
library(forcats)
```
# <br>
##### 1. Read the beers data file Beers.csv and inspect the dataframe (head and tail).

```{r}
library(readr)
Beers <- read_csv("Beers.csv")
head(Beers)
```

```{r}
tail(Beers)
```

##### 2. Read the breweries data file Breweries.csv and inspect the dataframe (head and tail).
```{r}
library(readr)
Breweries <- read_csv("Breweries.csv")
```
```{r}
head(Breweries)
```

```{r}
tail(Breweries)
```
##### 3. Inspect the data structures, rename columns that make sense and prepare to join the data sets. Joining could be accomplished with a left, right or full join. Full join is used in this case to preserve data from both tables.
```{r}
str(Breweries)
```

```{r}
str(Beers)
```
```{r}
names(Breweries)
```
##### Renamed Brewery_id to match the Brew_ID inthe Breweries dataset.
```{r}
names(Beers)
```
```{r}
Beers <- rename(Beers, Brew_ID = Brewery_id)
names(Beers)
```
##### Full join method.
```{r}
fullData <- full_join(Breweries, Beers, by = "Brew_ID")
```

```{r}
head(fullData)
```
##### Another column renaming is needed to correct the data names after the join. 
```{r}
fullData <- rename(fullData, BreweryName = Name.x, BeerName = Name.y)
names(fullData)
```
```{r}
fullData %>%
  group_by(State) %>%
  summarise(count = n())
```
##### Exploring the number of breweries in each state, the Breweries.csv data is used. Grouped the Breweries data table by states.
```{r}
BrewStatesC <- Breweries%>%
  group_by(State)%>%
  summarise(count = n())
```

```{r}
head(BrewStatesC)
```
```{r}
state.freq <- table(Breweries$State)
barplot(state.freq[order(state.freq)], 
        horiz = T,
        border = NA,
        xlim = c(0, 100),
        main = "Number of Breweries per State",
        xlab = "Number of Brewiews",
        ylab = "States")
```
#<br> 
# Counting the number of brewweries in each state:

```{r}
head(state.freq)
```

```{r}
sDF<-data.frame(state.freq) 
sDF<- rename(sDF, State = Var1, Brew_Count=Freq)
```

#<br>

##### Plot the number of breweries in each state.

```{r}
p1 <- ggplot(Breweries, aes(x = fct_rev(fct_infreq(State)), fill = fct_infreq(State))) + geom_bar() + coord_flip() + theme(legend.position = "top")

ggplotly(p1)  
```

##### Plot the number of beer brands from each state.

```{r}
p2 <- ggplot(fullData, aes(x = fct_rev(fct_infreq(State)), fill = fct_rev(fct_infreq(State)))) + geom_bar() + coord_flip() + theme(legend.position = "top")

ggplotly(p2)
```

##### Did we have any empty rows in our data tables? Let's find out here:

```{r}
naB_Id<-sum(is.na(fullData$Brew_ID))
naB_Nm<-sum(is.na(fullData$BreweryName))
naB_C<-sum(is.na(fullData$City))
naB_S<-sum(is.na(fullData$State))
naBeer_Nm<-sum(is.na(fullData$BeerName))
naBeer_Id<-sum(is.na(fullData$Beer_ID))
naABV<-sum(is.na(fullData$ABV))
naIBU<-sum(is.na(fullData$IBU))
naStyle<-sum(is.na(fullData$Style))
naOunces<-sum(is.na(fullData$Ounces))


naResults = paste(naB_Id, naB_Nm, naB_C, naB_S, naBeer_Nm, naBeer_Id, naABV, naIBU, naStyle, naOunces, sep = ", ")

print(naResults)
```
```{r}

```


