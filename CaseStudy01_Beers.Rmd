---
<<<<<<< HEAD
title: "Evaluation of Craft Breweries in the <br> United States of America <br>"
author: "<br>Heindel Adu, Amy Markmum and Gabriel Gonzalez <br>- AGH Data Consult Inc."
date: "Spring 2019"
output:
  html_document:
    highlight: pygments
    keep_md: yes
    theme: united
    always_allow_html: yes
  pdf_document: default
=======
title: "CaseStudy01_Beers"
author: "AMarkum"
date: "2/24/2019"
output: html_document
>>>>>>> 8dc4c824c1488b586e2922e2198a1dca639cd6ea
---

```{r setup, include=FALSE}
<<<<<<< HEAD
library(tidyr)
library(dplyr)
library(plotly)
library(forcats)
library(ggmap)
library(maps)
library(ggplot2)

register_google(key = 'AIzaSyBODcDvf37-5ae26FN1Oe5uStngqlccrXc')
=======
knitr::opts_chunk$set(echo = TRUE)
>>>>>>> 8dc4c824c1488b586e2922e2198a1dca639cd6ea
```

## DDS6306_CaseStudy01
Git repository project entitled "Case Study 1." Members of this project include Heindel Adu, Gabriel Gonzales, and Amy Markum. 

## Introduction: This presentation provides an overview of exactly what type of manipulations were performed on two combined data sets (Beer by State and Breweries by State). Client has requested answers to the five following questions:

### Number of Breweries per state
### Number of NA values returned for each data set
### Median ABV and IBU counts for each state, and provide a comparative bar chart
### States with maximum ABV and IBU, respectively
### Determination of any relationship between ABV and IBU, and provide comparative scatter plot

## First, it is necessary to merge the tables using a specific code in r
### Brew_Beer_Table <- right_join(Breweries, Beers, by="Brew_ID")

## Second, it's a good idea to save your file before manipulating the data, in case you need to return to the original data
### write.csv(Brew_Beer_Table, file = "Breweries_Beer.csv")

<<<<<<< HEAD
```{r}
head(fullData)
```
##### Another column renaming is needed to correct the data names after the join. 
```{r}
fullData <- rename(fullData, BreweryName = Name.x, BeerName = Name.y)
names(fullData)
```
```{r}
fullData %>%
  group_by(State) %>%
  summarise(count = n())%>%
  arrange(desc(count))
```
##### Exploring the number of breweries in each state, the Breweries.csv data is used. Grouped the Breweries data table by states.
```{r}
BrewStatesC <- Breweries%>%
  group_by(State)%>%
  summarise(count = n())%>%
  arrange(desc(count))
```

```{r}
head(BrewStatesC)
```
```{r}
state.freq <- table(Breweries$State)
barplot(state.freq[order(state.freq)], 
        horiz = T,
        border = NA,
        xlim = c(0, 100),
        main = "Number of Breweries per State",
        xlab = "Number of Brewiews",
        ylab = "States")
```
#<br> 
# Counting the number of brewweries in each state:

```{r}
head(state.freq)
```
=======
## Third, you should rename all columns to be easily human readable
### names(Brew_Beer_Table) <- c("Brewery_ID", "Brewery_Name", "City", "State", "Beer_Name", "Beer_ID", "ABV", "IBU", "Beer_Style", "Ounces")
>>>>>>> 8dc4c824c1488b586e2922e2198a1dca639cd6ea

## Any data should be sorted to assist in understanding the data set, in this case sorted first by Brewery ID, then by ABV (ascending)
### attach(Brew_Beer_Table)
### SortedBreweryTable <- Brew_Beer_Table[order(Brewery_ID, ABV), ]
### write.csv(SortedBreweryTable, file = "Breweries_Beer.csv")

## It's always a good idea to review your dataset to ensure everything is as it should be
### head(SortedBreweryTable, 10)
### tail(SortedBreweryTable, 10)

## Next we begin to answer the client's questions: Identify all of the NA's: (62 in the ABV column, 1005 in IBU)
### sapply(SortedBreweryTable, function(x) sum(is.na(x)))

<<<<<<< HEAD
```{r}
p1 <- ggplot(Breweries, aes(x = fct_rev(fct_infreq(State)), fill = fct_infreq(State))) + geom_bar() + coord_flip() + theme(axis.title.x=element_blank(),                                                                                                                   axis.title.y=element_blank(),legend.position = "none")

=======
## Then identify how many breweries are in each state
### StateBreweryTotals <- SortedBreweryTable %>% group_by(State) %>% summarize(count=n())
>>>>>>> 8dc4c824c1488b586e2922e2198a1dca639cd6ea

## Any data that is separated out and may be needed for later mainpulation should be stored in its own file
###write.csv(StateBreweryTotals, file = "Breweries-State.csv")

## We provide a barplot indicating the number of breweries per state
### ggplot(StateBreweryTotals, aes(x=State, y=count)) + geom_bar(stat="identity")

<<<<<<< HEAD
```{r}
p2 <- ggplot(fullData, aes(x = fct_rev(fct_infreq(State)), fill = fct_rev(fct_infreq(State)))) + geom_bar()  + theme(legend.position = "none") +
  labs( title = "", x = "none", y = "Count of Beer") + theme(axis.title.x=element_blank(),                                                                                                                   axis.title.y=element_blank(),legend.position = "none")
=======
## Identify the overall median ABV and IBU counts
### ABV <- Breweries_Beer$ABV
### median(ABV, na.rm = TRUE)
>>>>>>> 8dc4c824c1488b586e2922e2198a1dca639cd6ea

### IBU <- Breweries_Beer$IBU
### median(IBU, na.rm = TRUE)

## Split out your data so you can work with your ABV & IBU variables by state
### ABVState <-split(Breweries_Beer$ABV, Breweries_Beer$State)
### IBUState <-split(Breweries_Beer$IBU, Breweries_Beer$State)

## Identify your medians by state (example given)
### median(ABVState[["CA"]], na.rm = TRUE)
### median(IBUState[["CA]], na.rm = TRUE)

## Create your new file with your states/median ABV information
### write.csv(ABVStates, file = "ABVStates.csv")

## Create your new file with your states/median IBU information
### write.csv(IBUStates, file = "IBUStates.csv")

<<<<<<< HEAD
print(naResults)
```
```{r}
names(fullData)

```

```{r}
select(fullData, State, ABV, IBU)

```
```{r}
Breweries %>%
  group_by(State) %>%
  tally(sort = TRUE)
```
```{r}
fullData %>%
  group_by(State) %>%
  summarise(state_count = n()) %>%
  arrange(desc(state_count))
```

```{r}
mFD <- fullData %>%
  group_by(State) %>%
  summarise_each(funs(mean), mean_ABV = ABV, mean_IBU = IBU) %>%
  arrange(desc(mean_ABV))
```

```{r}
ggplot(fullData, aes(x = ABV)) + 
  geom_bar(na.rm = T) + 
  theme_grey() + 
   coord_flip()
```
```{r}
p11<-ggplot(fullData, aes(x = IBU, fill = "red")) + 
  geom_bar(na.rm = T) + 
  scale_color_brewer("Blues")
ggplotly(p11)
```

```{r}
fullData %>%
  group_by(State) %>%
  summarise_each(funs(min, max), ABV) 
```

```{r}
mFDt<- data.frame(fullData %>%
  group_by(State) %>%
  summarise ( min_ABV =min(ABV), mean_ABV = mean(ABV), max_ABV = max(ABV)) %>%
  arrange(desc(max_ABV)))
```

```{r}
mIBU<- fullData %>%
  group_by(State) %>%
    summarise (min_IBU =min(IBU), mean_IBU = mean(IBU), max_IBU = max(IBU)) %>%
  arrange(desc(max_IBU))
```


```{r}
fullData %>%
    group_by(BreweryName) %>%
    summarise ( min_IBU =min(IBU), mean_IBU = mean(IBU), max_IBU = max(IBU)) %>%
  arrange(desc(max_IBU))
```
```{r}
coef(lm(IBU ~ ABV, data = fullData))
```



#### Colored by State
```{r}
ggplot(fullData, aes(ABV, IBU, colour = State)) +
     geom_point(na.rm = T) +
  geom_abline(intercept = -34.09865, slope = 1282.037)
```
```{r}
ggplot(fullData, aes(ABV, IBU, colour = ABV)) +
     geom_point(aes(colour = ABV), na.rm = T) +
  geom_abline(intercept = -34.09865, slope = 1282.037)
```
#### Color by state
```{r}
ggplot(fullData, aes(ABV, IBU, colour = State)) +
  facet_wrap(~ State) +
    geom_point(na.rm = T) +
  geom_abline(intercept = -34.09865, slope = 1282.037) 
```
#### Color by alcohol volume

```{r}
ggplot(fullData, aes(ABV, IBU, colour = State)) +
  facet_wrap(~ State) +
    geom_point(aes(colour = ABV),na.rm = TRUE) +
  geom_abline(intercept = -34.09865, slope = 1282.037)
```


```{r}
ggplot(fullData, aes(ABV, IBU, colour = State)) +
  facet_wrap(~ Style) +
    geom_point(aes(colour = ABV),na.rm = TRUE) +
  geom_abline(intercept = -34.09865, slope = 1282.037)
```

```{r}
ggplot(fullData, aes(State, ABV)) +
  geom_boxplot(na.rm = T)
```
```{r}
ggplot(fullData, aes(State, IBU)) +
  geom_boxplot(na.rm = T) 
```

```{r}
ggplot(fullData, aes(ABV, IBU, colour = ABV)) +
     geom_point(aes(colour = ABV), na.rm = T) +
  geom_abline(intercept = -34.09865, slope = 1282.037) + 
  geom_smooth(method = lm, se = T, na.rm = T)
```
#####Density map of ABV vs IBU. 
```{r}
dplot<-ggplot(fullData, aes(ABV, IBU, colour = ABV)) +
     geom_point( na.rm = T)

dplot + stat_density_2d(aes(fill= ..level.., alpha = 0.75 ) , na.rm = T, geom = "polygon")
```
=======
## Provide a summary of the ABV statistics
### str(ABVStates)

## Provide a scatter plot of your ABV & IBU Levels
### plot(IBULvl, ABVLvl, main = "ABV & IBU Comparison Chart", xlab="IBU Levels", ylab="ABV Levels", pch = 19, frame = FALSE)

## Provide a comparative bar chart of the median ABV & IBU Levels
### data <- data.frame(States, ABVLvl, IBULvl)
### plot_ly(data, x = ~States, y = ~ABVLvl, type = "bar", name = "ABV Level") %>% add_trace(y=~IBULvl, name="IBU Level") %>% layout(yaxis = list(title = "ABV&IBU Comparison"), barmode = "Group")
>>>>>>> 8dc4c824c1488b586e2922e2198a1dca639cd6ea

## NOTE: Although this was requested, a comparative barchart is inappropriate for ABV & IBU Levels due to the difference in scale